'use strict';!function(require,directRequire){const a=require('react'),b=require('./6620a0cf7dad1b400d60f0fdae40f524.js'),c=require('./56c390e04c10e91a4aa2a2c19d9a885d.js'),d=require('./bc04f89cf8edab62335086e0a2a5a103.js'),e=require('./da7c31daaf542cf1796023d8e344b98a.js'),f=require('./d3976cc01aeebc5b09e11c4135b6bd8d.js'),g=require('./5498e660c05c574f739a28bd5d202cfa.js'),h=c.SELECT_PROJECT_TAB,i=require('./common/locales/index.js');module.exports=class extends a.Component{constructor(a){super(a),this.switchTab=(a)=>{const b=a.currentTarget.dataset.type;'minicode'===b?this.props.currentTab!==h.MINI_CODE&&this.props.selectProjectRequest({tab:h.MINI_CODE}):this.props.currentTab!==h.PROJECT&&this.props.selectProjectRequest({tab:h.PROJECT})},this.filterProjectsByTab=(a)=>{try{return this.props.currentTab===h.MINI_CODE?a.isMiniCode:!a.isMiniCode}catch(a){return!0}},this.handleMaskClick=()=>{this.setState({showMask:!1})},this._compareProject=this.compareProject.bind(this),this.state={showMask:!1,focus:''},this.setupController()}componentDidMount(){this.resize(),this._cancalLocaleListener=i.onChangeLocale(()=>this.forceUpdate())}componentWillUnmount(){this._cancalLocaleListener()}setupController(){}resize(){try{let a=this.props.win?this.props.win:global.Win;this.props.detach||(a.setResizable(!0),a.resizeTo(c.SIZE.SELECT_PROJECT.WIDTH,c.SIZE.SELECT_PROJECT.HEIGHT),a.setResizable(!1))}catch(a){}}cancel(){this.props.cancel()}manageProjects(){this.props.setProjectManagement({show:!0,type:'project',filter:(a)=>!a.isMiniCode}),e('weapp_manager')}manageMiniCode(){this.props.setProjectManagement({show:!0,type:'minicode',filter:(a)=>a.isMiniCode}),e('weapp_manager')}createMiniCode(){switch(this.props.mainWindow){case c.MAIN_WINDOW_TYPE.DEV:case c.MAIN_WINDOW_TYPE.WEB_DEBUGGER:{this.props.createMiniCodeOpen('create');break}default:this.props.createMiniCodeRequest('create');}}importMiniCode(){switch(this.props.mainWindow){case c.MAIN_WINDOW_TYPE.DEV:case c.MAIN_WINDOW_TYPE.WEB_DEBUGGER:{this.props.createMiniCodeOpen('import');break}default:this.props.createMiniCodeRequest('import');}}handleQuitClick(){f.quit()}focusProject(a){const b=a.currentTarget.dataset.projectid;this.setState({focus:b})}openProject(a){if(this.props.currentProject){this.props.closeProject();const b=a.currentTarget.dataset.projectid;setTimeout(()=>this.props.openProject(b),50)}else this.props.openProject(a.currentTarget.dataset.projectid)}createProject(){switch(this.props.mainWindow){case c.MAIN_WINDOW_TYPE.DEV:case c.MAIN_WINDOW_TYPE.WEB_DEBUGGER:{this.props.createProjectOpen();break}default:this.props.createProjectRequest();}}jumpMiniCodeDoc(){nw.Shell.openExternal('https://developers.weixin.qq.com/miniprogram/dev/devtools/minicode.html')}compareProject(c,a){try{return(this.props.projects[a].accessTime||1)-(this.props.projects[c].accessTime||1)}catch(a){return!1}}render(){let b=[],c=[];Object.keys(this.props.projects).sort(this._compareProject).forEach((d)=>{const e=this.props.projects[d];if(e.isMiniCode){const b=e.attr&&e.attr.appImageUrl||g.default_weapp_header;c.push(a.createElement('div',{className:this.state.focus===e.projectid?'snippet-item snippet-item-active':'snippet-item',key:d,"data-projectid":e.projectid,onClick:this.openProject.bind(this)},a.createElement('div',{className:'snippet-hd'},a.createElement('img',{className:'snippet-avatar',src:b,alt:''})),a.createElement('div',{className:'snippet-bd'},a.createElement('h4',{className:'snippet-name'},decodeURIComponent(e.projectname)),a.createElement('p',{className:'snippet-desc'},e.projectpath)),a.createElement('div',{className:'snippet-ft'})))}else{const c=e.attr&&e.attr.appImageUrl||g.default_weapp_header,f={backgroundSize:'cover'};this.props.covers[e.projectid]?f.backgroundImage=`url('${this.props.covers[e.projectid]}')`:f.backgroundColor='#EDEDED',b.push(a.createElement('div',{className:this.state.focus===e.projectid?'project-item project-item-active':'project-item',key:d,"data-projectid":e.projectid,onClick:this.openProject.bind(this)},a.createElement('div',{className:'project-item-cover',style:f}),a.createElement('div',{className:'project-logo'},a.createElement('img',{src:c,alt:''})),a.createElement('div',{className:'project-info'},a.createElement('h4',null,decodeURIComponent(e.projectname)),a.createElement('p',null,e.projectpath))))}});const d=this.props.detach?{display:'none'}:{},e={WebkitAppRegion:'no-drag'};return a.createElement('div',null,this.state.showMask?a.createElement('div',{className:'ui-mask ui-mask-transparent',onClick:this.handleMaskClick}):null,a.createElement('div',{className:'dashboard'},a.createElement('div',{className:'dashboard-commands',style:{WebkitAppRegion:'drag'}},a.createElement('div',{className:'dashboard-navigator',style:d},a.createElement('a',{style:e,onClick:this.props.cancel},a.createElement('i',{className:'ui-icon-back'}))),a.createElement('div',{className:'dashboard-brand'},a.createElement('div',{className:'dashboard-logo'},a.createElement('i',{className:'ui-icon-mini-app'})),a.createElement('h3',{className:'dashboard-caption'},i.config.MINI_PROGRAM_PROJECT),a.createElement('p',{className:'dashboard-subtitle'},i.config.MINI_PROGRAM_PROJECT_DEBUG)),a.createElement('div',{className:'dashboard-content'},a.createElement('section',{className:'dashboard-content-section'},a.createElement('h4',null,i.config.HELP),a.createElement('ul',null,a.createElement('li',{style:e},a.createElement('a',{onClick:this.props.openDoc},i.config.MINI_PROGRAM_DEV_DOC)),a.createElement('li',{style:e},a.createElement('a',{onClick:this.props.openBBS},i.config.MINI_PROGRAM_DEV_BBS))))),a.createElement('div',{className:'dashboard-command-ft'},a.createElement('div',{className:'luncher-account',style:e},a.createElement('div',{className:'luncher-account-avatar'},a.createElement('img',{src:this.props.user?this.props.user.headUrl:'',alt:''})),a.createElement('div',{className:'luncher-account-name',onClick:this.props.logout},a.createElement('p',null,i.config.MENU_SWITCH_ACCOUNT),a.createElement('i',{className:'ui-icon-arrow-right-o'}))))),a.createElement('div',{className:'dashboard-splash'},a.createElement('div',{className:'dashboard-splash-bd'},a.createElement('div',{className:'tab'},a.createElement('div',{className:'tab-hd'},a.createElement('div',{className:'tab-hd-item'+(this.props.currentTab===h.PROJECT?' tab-hd-item-active':''),"data-type":'project',onClick:this.switchTab},i.config.PROJECT),a.createElement('div',{className:'tab-hd-item'+(this.props.currentTab===h.MINI_CODE?' tab-hd-item-active':''),"data-type":'minicode',onClick:this.switchTab},i.config.CODE_SEGMENT)),a.createElement('div',{className:'tab-bd'},a.createElement('div',{className:'tab-content'+(this.props.currentTab===h.PROJECT?' tab-content-active':'')},a.createElement('div',{className:'miniapps'},a.createElement('div',{className:'miniapp-list'},b),a.createElement('div',{className:'miniapp-opr'},a.createElement('div',{className:'ui-flex'},a.createElement('div',{className:'ui-flex-item'},a.createElement('a',{style:e,onClick:this.manageProjects.bind(this)},i.config.PROJECT_MANAGE)),a.createElement('div',null,a.createElement('a',{style:e},a.createElement('i',{className:'ui-icon-plus',onClick:this.createProject.bind(this)}))))))),a.createElement('div',{className:'tab-content'+(this.props.currentTab===h.MINI_CODE?' tab-content-active':'')},a.createElement('div',{className:'snippets'},a.createElement('div',{className:'snippet-list'},c,0<c.length?null:a.createElement('div',{className:'snippet-item-empty'},a.createElement('p',null,i.config.CODE_SEGMENT_DETAIL,' ',a.createElement('a',{onClick:this.jumpMiniCodeDoc,href:'javascript:;'},i.config.DOC_URL)))),a.createElement('div',{className:'snippet-opr'},a.createElement('div',{className:'ui-flex'},a.createElement('div',{className:'ui-flex-item'},a.createElement('a',{style:e,onClick:this.manageMiniCode.bind(this)},i.config.CODE_SEGMENT_MANAGE)),a.createElement('div',null,a.createElement('a',{style:e,onClick:this.createMiniCode.bind(this)},i.config.CODE_SEGMENT_NEW),a.createElement('span',{className:'snippet-opr-sep'}),a.createElement('a',{style:e,onClick:this.importMiniCode.bind(this)},i.config.CODE_SEGMENT_IMPORT))))))))))))}}}(require('lazyload'),require);