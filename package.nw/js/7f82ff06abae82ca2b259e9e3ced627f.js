;!function(require, directRequire){;"use strict";const path=require("path"),vendorManager=require('./d28a711224425b00101635efe1034c99.js'),transWXMLToJS=require('./3e4c71c2a2cc438e1b3afc3fb10bd4b6.js'),transWXSSToJS=require('./709f7f8328edb932b1169de8b7e694dd.js'),getWxAppCode=require('./0a856a8f0b27fbeca81fbaabad89dd1e.js'),apperrorConfig=require('./949d8235c744ced2a80121e4dba34c28.js'),parseErr=require('./6238a86bb7a55c11aa0f9eb335d0f34c.js'),consoleDisplay=require('./2dfc6a3df6d6fc51266b293c8420e88b.js'),store=require('./bc78839ccca8df9e5ceeb7fae11b7be2.js'),C=require('./56c390e04c10e91a4aa2a2c19d9a885d.js'),compileCache=require('./2e9637e8a0816a626f7db9a0dee5efe8.js'),topTools=require('./84b183688a46c9e2626d3e6f83365e13.js'),{jsDebug,htmlBegin,errorTpl,devVendorList,vendorList,wxappcodePlaceholder,jsdebugPlaceholder,vendorListPlaceholder,deviceInfoPlaceholder,wxmlcodePlaceholder,wxsscodePlaceholder,htmltpl}=require('./59a36d89a8b99d7d2d809add2cecd72e.js'),vendors=global.appConfig.isDev&&!nw.App.manifest.forceVendor?devVendorList:vendorList;let lastDeviceInfo={};function resetCache(){compileCache.remove(compileCache.CACHE_KEYS.JS_PAGEFRAME)}function getDeviceInfoScript(a){const b=a.toolbar.deviceInfo||{},c={pixelRatio:b.dpr,width:b.screenWidth};return`<script charset="UTF-8"> window.__deviceInfo__ = ${JSON.stringify(c)} </script>`}function checkDevice(a){const b=a.toolbar.deviceInfo;(lastDeviceInfo.screenWidth!==b.screenWidth||lastDeviceInfo.dpr!==b.dpr)&&resetCache(),lastDeviceInfo=b}async function getPageFrame(a,b={}){await compileCache.init(a);const c=store.getState();checkDevice(c);const d=compileCache.CACHE_KEYS.JS_PAGEFRAME;let e=compileCache.get(d);if(!e)try{const b=getDeviceInfoScript(c),f=`<script charset="UTF-8">${jsDebug}</script>`,g=await transWXMLToJS(a,{app:!0}),h=await transWXSSToJS(a,{app:!0});let i="";h&&(i=`<script charset="UTF-8">eval('${h}')</script>`);const j=await getWxAppCode(a,{app:!0}),k=[];for(let a=0,b=vendors.length;a<b;a++){const b=vendors[a],c=path.extname(b);".js"===c?k.push(`<script src='./__dev__/${b}' charset="UTF-8"></script>`):".css"===c&&(k.push(`<link rel="stylesheet" type="text/css" href='./__dev__/${b}' />`),k.push(`<script>
            var link = document.createElement('link'); 
            link.rel = 'stylesheet'; 
            link.type = 'text/css'; 
            link.href = './__dev__/wx-components.css';
            document.head.appendChild(link)
          </script>`))}e=htmltpl.split(deviceInfoPlaceholder).join(b).split(jsdebugPlaceholder).join(f).split(wxmlcodePlaceholder).join(`<script charset="UTF-8">${g.code}</script>`).split(wxsscodePlaceholder).join(i).split(wxappcodePlaceholder).join(`<script charset="UTF-8">${topTools.escapeScript(j)}</script>`).split(vendorListPlaceholder).join(k.join("\n")),compileCache.set(d,e)}catch(b){let c;if(b.code===apperrorConfig.TRANS_WXML_JS_ERR?c=await parseErr.parseWxmlErr(a,b.msgForConsole):b.code===apperrorConfig.TRANS_WXSS_JS_ERR&&(c=await parseErr.parseWxssErr(a,b)),c){const a=errorTpl.replace("{{error}}",(c.file?`in File: ${c.file}`:"")+(c.msg?`<pre style="white-space:pre-wrap; font-family: monospace;">${c.msg.replace(/</g,"&lt;").replace(/>/g,"&gt;")}</pre>`:"")+(b.message?`<p>${b.message}</p>`:""));throw new Error(a)}else throw consoleDisplay.display({command:C.DISPLAY_ERROR,data:{error:b}}),b}return e}vendorManager.on("VENDOR_CONFIG_CHANGE",resetCache),vendorManager.on("VENDOR_VERSION_CHANGE",resetCache),module.exports=getPageFrame;
;}(require("lazyload"), require);
