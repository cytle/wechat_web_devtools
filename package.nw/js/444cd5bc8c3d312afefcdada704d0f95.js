'use strict';!function(require,directRequire){const a=require('react'),b=require('redux'),c=require('moment'),d=require('./a8c87029da0fa06e986298d447ab0fe2.js'),e=require('./cc2c2970ff81ae4a83123e81ee123da2.js'),f=require('./25d0beb4120ce2acafb4e03b95444fda.js'),g=require('./1fcc6bd55b687d154a4247e57fe3011d.js'),h=require('./0794878a22a26634e42df858bbaca543.js'),i=require('./56c390e04c10e91a4aa2a2c19d9a885d.js'),j=require('./72410b6d4968336cd8b2fc1d41f52cdf.js'),k=require('./3b5f8e2469c474c8d433c1c6926d8999.js'),l=require('./common/locales/index.js'),m=require('./875171e7b864aa58d026d4fa0999fbd1.js'),{connect:n}=require('react-redux'),{selectLanguageEnv:o}=require('./0794878a22a26634e42df858bbaca543.js'),p=require('./d3976cc01aeebc5b09e11c4135b6bd8d.js');class q extends a.Component{constructor(a){super(a),this.state={env:'nodejs',show:a.show,showLoading:!1}}componentDidMount(){this._cancalLocaleListener=l.onChangeLocale(()=>this.forceUpdate())}componentWillUnmount(){this._cancalLocaleListener()}componentWillReceiveProps(a){a.show!=this.props.show&&this.setState({show:a.show})}toggleEnvSelect(a){this.setState({env:a})}onClose(){this.setState({show:!1})}async onConfirm(){try{this.setState({showLoading:!0});const a=await o(this.state.env);console.log(a),await this.props.requestProjectAttr(!0)}catch(a){this.setState({showLoading:!1,show:!1}),this.props.notifyFail(a)}this.setState({show:!1})}onAnimationOut(){this.props.close(),this.setState({showLoading:!1})}render(){const b=this.props;return a.createElement(m,{show:this.state.show,style:{width:420,marginLeft:-210},inClassName:'ui-animate-pull-down ui-dialog',outClassName:'ui-animate-pull-up ui-dialog',onAnimationOut:this.onAnimationOut.bind(this)},a.createElement('div',{className:'ui-dialog-hd'},a.createElement('h3',{className:'ui-dialog-title'},l.config.CHOOSE_PRODUCTION_ENVIRONMENT)),a.createElement('div',{className:'ui-dialog-bd',style:{position:'relative'}},a.createElement('div',{style:{textAlign:'center',position:'absolute',width:'100%',height:'100%',left:'0',top:'0',margin:'0',padding:'0',zIndex:9,display:this.state.showLoading?'block':'none'}},a.createElement('i',{className:'weui-loading weui-icon_toast',style:{margin:'0',position:'relative',top:'50%',marginTop:'-20px'}})),a.createElement('div',{style:{visibility:this.state.showLoading?'hidden':'visible'}},a.createElement('div',{className:'ui-form'},a.createElement('div',{className:'ui-form-item ui-form-item-inline'},a.createElement('div',{className:'ui-form-controls'},a.createElement('label',{className:'ui-radio ui-radio-vt',onClick:this.toggleEnvSelect.bind(this,'nodejs')},a.createElement('i',{className:'nodejs'===this.state.env?'ui-icon-radio-o':'ui-icon-radio'}),a.createElement('div',{className:'ui-radio-text'},a.createElement('p',null,'Node.js ',l.config.PRODUCTION_ENVIRONMENT),a.createElement('p',{className:'ui-desc'},l.config.INCLUDES,' Node.js 8.2.1'))))),a.createElement('div',{className:'ui-form-item ui-form-item-inline'},a.createElement('div',{className:'ui-form-controls'},a.createElement('label',{className:'ui-radio ui-radio-vt',onClick:this.toggleEnvSelect.bind(this,'php')},a.createElement('i',{className:'php'===this.state.env?'ui-icon-radio-o':'ui-icon-radio'}),a.createElement('div',{className:'ui-radio-text'},a.createElement('p',null,'PHP ',l.config.PRODUCTION_ENVIRONMENT),a.createElement('p',{className:'ui-desc'},l.config.INCLUDES,' PHP 5.6.30')))))))),a.createElement('div',{className:'ui-dialog-ft'},a.createElement('div',{className:'ui-dialog-action'},a.createElement('button',{className:'ui-button ui-button-default',onClick:this.onClose.bind(this)},l.config.CANCEL),a.createElement('button',{disabled:this.state.showLoading,className:'ui-button ui-button-primary',onClick:this.onConfirm.bind(this)},l.config.CONFIRM))))}}module.exports=n((a)=>{const b=a.project.current;return{qcloud:b&&b.qcloud,show:a.window.qcloud.deployShow,project:b}},(a)=>({close:()=>{a(d.setQCloud({deployShow:!1}))},requestProjectAttr:p.bindActionCreators(e.requestProjectAttr,a),notifyFail:(b)=>a(g.setConfirmInfo({show:!0,showCancel:!1,title:l.config.CHOOSE_ENVIRONMENT_ERROR,content:b,callback:async()=>{a(g.setConfirmInfo({show:!1}))}}))}))(q)}(require('lazyload'),require);